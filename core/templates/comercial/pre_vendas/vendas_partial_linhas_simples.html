{% for venda in page_obj %}
<tr>
    <td>
        <strong>{{ venda.codigo|default:"SEM-CÓDIGO" }}</strong>
    </td>
    <td>
        <div>
            <strong>{{ venda.cliente.nome|default:"Cliente não definido" }}</strong>
            {% if venda.cliente.cpf %}
            <small class="text-muted d-block">CPF: {{ venda.cliente.cpf }}</small>
            {% elif venda.cliente.cnpj %}
            <small class="text-muted d-block">CNPJ: {{ venda.cliente.cnpj }}</small>
            {% endif %}
        </div>
    </td>
    <td>
        {% if venda.bloqueio %}
        <div>
            <strong>{{ venda.bloqueio.descricao|default:"Sem descrição"|truncatechars:30 }}</strong>
            <small class="text-muted d-block">
                <i class="fas fa-plane me-1"></i>
                {{ venda.bloqueio.saida|date:"d/m/Y" }}
            </small>
        </div>
        {% else %}
            <span class="text-muted">Não definido</span>
        {% endif %}
    </td>
    <td>
        <span class="badge bg-info fs-6">{{ venda.numero_passageiros|default:0 }}</span>
    </td>
    <td>
        <strong class="text-primary">R$ {{ venda.valor_total|floatformat:2|default:"0,00" }}</strong>
        {% if venda.valor_pendente > 0 %}
        <small class="text-warning d-block">
            Pendente: R$ {{ venda.valor_pendente|floatformat:2 }}
        </small>
        {% endif %}
    </td>
    <td>
        <div>
            {{ venda.data_venda|date:"d/m/Y H:i"|default:"-" }}
            <small class="text-muted d-block">{{ venda.vendedor.get_full_name|default:venda.vendedor.username }}</small>
        </div>
    </td>
    <td>
        <div class="btn-group btn-group-sm" role="group">
            <a href="{% url 'comercial:pre_venda_detalhe' venda.id %}" 
               class="btn btn-outline-primary" 
               title="Ver detalhes"
               data-bs-toggle="tooltip">
                <i class="fas fa-plus"></i>
            </a>
            <button type="button"
                    class="btn btn-outline-danger"
                    title="Remover venda"
                    data-bs-toggle="tooltip"
                    hx-delete="{% url 'comercial:remover_venda' venda.id %}"
                    hx-target="closest tr"
                    hx-swap="outerHTML swap:1s"
                    hx-confirm="Tem certeza que deseja remover esta venda?">
                <i class="fas fa-trash"></i>
            </button>
        </div>
    </td>
</tr>
{% endfor %}