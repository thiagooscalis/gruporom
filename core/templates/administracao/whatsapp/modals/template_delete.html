<div class="modal-header">
    <h5 class="modal-title">
        <i class="fas fa-trash text-danger me-2"></i>
        Excluir Template
    </h5>
    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
</div>

<div class="modal-body">
    <div class="alert alert-warning">
        <i class="fas fa-exclamation-triangle me-2"></i>
        <strong>Atenção!</strong> Esta ação não pode ser desfeita.
    </div>
    
    <p>Você tem certeza que deseja excluir o template:</p>
    
    <div class="card">
        <div class="card-body">
            <div class="d-flex justify-content-between align-items-start">
                <div>
                    <h6 class="card-title">{{ template.display_name }}</h6>
                    <p class="card-text">
                        <small class="text-muted">
                            <strong>Nome técnico:</strong> {{ template.name }}<br>
                            <strong>Categoria:</strong> {{ template.get_category_display }}<br>
                            <strong>Idioma:</strong> {{ template.get_language_display }}<br>
                            <strong>Conta:</strong> {{ template.account.name }}
                        </small>
                    </p>
                </div>
                <span class="badge {{ template.get_status_badge_class }}">
                    {{ template.get_status_display }}
                </span>
            </div>
            
            {% if template.body_text %}
            <div class="mt-3">
                <small class="text-muted"><strong>Conteúdo:</strong></small>
                <div class="border rounded p-2 bg-light small">
                    {% if template.header_text %}
                        <div class="fw-bold">{{ template.header_text }}</div>
                    {% endif %}
                    <div>{{ template.body_text|truncatechars:150 }}</div>
                    {% if template.footer_text %}
                        <div class="text-muted">{{ template.footer_text }}</div>
                    {% endif %}
                </div>
            </div>
            {% endif %}
        </div>
    </div>
    
    {% if template.status == 'approved' %}
    <div class="alert alert-danger mt-3">
        <i class="fas fa-exclamation-circle me-2"></i>
        <strong>Importante:</strong> Este template está aprovado e pode estar sendo usado ativamente. 
        Ao excluí-lo, não será mais possível enviar mensagens usando este template.
    </div>
    {% endif %}
</div>

<div class="modal-footer">
    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
        <i class="fas fa-times me-2"></i>Cancelar
    </button>
    <form hx-post="{{ action_url }}" 
          hx-target="#modalDeleteTemplate .modal-content" 
          hx-swap="innerHTML" 
          style="display: inline;">
        {% csrf_token %}
        <button type="submit" class="btn btn-danger">
            <i class="fas fa-trash me-2"></i>Confirmar Exclusão
        </button>
    </form>
</div>

<script>
// Evento de sucesso do HTMX para fechar modal e recarregar
document.body.addEventListener('htmx:afterRequest', function(event) {
    if (event.detail.successful && event.detail.xhr.getResponseHeader('HX-Trigger') === 'templateDeleted') {
        bootstrap.Modal.getInstance(document.getElementById('modalDeleteTemplate')).hide();
        location.reload();
    }
});
</script>