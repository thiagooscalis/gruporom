{% load core_tags %}

<!-- Linhas adicionais para "Carregar mais" -->
{% for pessoa in page_obj %}
<tr>
    <td>{{ pessoa.nome }}</td>
    <td>{{ pessoa.doc|doc|default:"-" }}</td>
    <td>{{ pessoa.email|default:"-" }}</td>
    <td>{{ pessoa.telefone|fone|default:"-" }}</td>
    <td class="text-center">
        {% if pessoa.empresa_gruporom %}
            <span class="badge bg-warning text-dark">Grupo ROM</span>
        {% elif pessoa.tipo_pessoa == 'FISICA' %}
            <span class="badge bg-info">PF</span>
        {% else %}
            <span class="badge bg-success">PJ</span>
        {% endif %}
    </td>
    <td>
        <button type="button" class="btn btn-sm btn-outline-primary" title="Editar"
                hx-get="{% url 'administracao:pessoas_editar_modal' pessoa.pk %}"
                hx-target="body"
                hx-swap="beforeend">
            <i class="fas fa-edit"></i>
        </button>
        <button type="button" class="btn btn-sm btn-outline-danger" title="Excluir"
                hx-get="{% url 'administracao:pessoas_excluir_modal' pessoa.pk %}"
                hx-target="body"
                hx-swap="beforeend">
            <i class="fas fa-trash"></i>
        </button>
    </td>
</tr>
{% endfor %}

<!-- Atualizar botão Carregar Mais -->
{% if page_obj.has_next %}
<script>
// Atualizar o botão existente
document.querySelector('#carregar-mais-container button').setAttribute('hx-get', 
    '{% url "administracao:pessoas_lista" %}?page={{ page_obj.next_page_number }}{% if search %}&search={{ search }}{% endif %}{% if tipo_filter %}&tipo={{ tipo_filter }}{% endif %}&load_more=1'
);
document.querySelector('#carregar-mais-container button').innerHTML = 
    '<i class="fas fa-plus me-2"></i>Carregar mais ({{ restantes }} restantes)';
// Re-processar HTMX
htmx.process(document.querySelector('#carregar-mais-container'));
</script>
{% else %}
<script>
// Remover botão se não há mais páginas
document.querySelector('#carregar-mais-container').remove();
</script>
{% endif %}