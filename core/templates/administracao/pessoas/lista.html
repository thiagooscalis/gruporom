{% extends "base.html" %}
{% load crispy_forms_tags %}
{% load core_tags %}

{% block title %}Pessoas - Administração{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            {% include 'includes/breadcrumbs.html' with prev_page='Administração' prev_url='/administracao/' cur_page='Pessoas' %}
            
            <!-- Busca e Filtros -->
            <div class="card mb-4">
                <div class="card-body">
                    <form method="get" class="row g-3" 
                          hx-get="{% url 'administracao:pessoas_lista' %}"
                          hx-target="#pessoas-lista"
                          hx-swap="outerHTML"
                          hx-push-url="true"
                          hx-trigger="submit">
                        <div class="col-md-7">
                            <input type="text" name="search" class="form-control" 
                                   placeholder="Buscar por nome, CPF/CNPJ ou email..." 
                                   value="{{ search }}">
                        </div>
                        <div class="col-md-3">
                            <select name="tipo" class="form-select">
                                <option value="">Todos os Tipos</option>
                                <option value="pf" {% if tipo_filter == 'pf' %}selected{% endif %}>Pessoa Física</option>
                                <option value="pj" {% if tipo_filter == 'pj' %}selected{% endif %}>Pessoa Jurídica</option>
                                <option value="gruporom" {% if tipo_filter == 'gruporom' %}selected{% endif %}>Empresa Grupo ROM</option>
                            </select>
                        </div>
                        <div class="col-md-2">
                            <button type="submit" class="btn btn-secondary w-100">
                                <i class="fas fa-search me-2"></i>Buscar
                            </button>
                        </div>
                    </form>
                </div>
            </div>
            
            <!-- Listagem (via partial com HTMX) -->
            {% include 'administracao/pessoas/partial_lista.html' %}
        </div>
    </div>
</div>

<!-- Floating Action Button -->
<a href="#" class="btn btn-primary rounded-circle fixed-br d-flex align-items-center justify-content-center"
   style="width: 56px; height: 56px;"
   hx-get="{% url 'administracao:pessoas_nova_modal' %}"
   hx-target="body"
   hx-swap="beforeend"
   title="Nova Pessoa">
    <i class="fas fa-plus text-white"></i>
</a>
{% endblock %}
